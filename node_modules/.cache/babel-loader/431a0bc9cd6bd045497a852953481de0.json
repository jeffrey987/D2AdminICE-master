{"remainingRequest":"/home/user1/桌面/vue/D2AdminICE-master/node_modules/babel-loader/lib/index.js!/home/user1/桌面/vue/D2AdminICE-master/node_modules/eslint-loader/index.js??ref--13-0!/home/user1/桌面/vue/D2AdminICE-master/src/store/modules/d2admin/modules/page.js","dependencies":[{"path":"/home/user1/桌面/vue/D2AdminICE-master/src/store/modules/d2admin/modules/page.js","mtime":1557910292529},{"path":"/home/user1/桌面/vue/D2AdminICE-master/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/user1/桌面/vue/D2AdminICE-master/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/user1/桌面/vue/D2AdminICE-master/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.set\";\nimport \"core-js/modules/es6.string.iterator\";\nimport \"core-js/modules/es6.array.from\";\nimport _toConsumableArray from \"/home/user1/\\u684C\\u9762/vue/D2AdminICE-master/node_modules/@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.array.find-index\";\nimport \"core-js/modules/es6.array.find\";\nimport \"core-js/modules/es6.function.name\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/home/user1/\\u684C\\u9762/vue/D2AdminICE-master/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport { remove, get } from 'lodash'; // 设置文件\n\nimport setting from '@/setting.js'; // 判定是否需要缓存\n\nvar isKeepAlive = function isKeepAlive(data) {\n  return get(data, 'meta.cache', false);\n};\n\nexport default {\n  namespaced: true,\n  state: {\n    // 可以在多页 tab 模式下显示的页面\n    pool: [],\n    // 当前显示的多页面列表\n    opened: setting.page.opened,\n    // 当前页面\n    current: '',\n    // 需要缓存的页面 name\n    keepAlive: []\n  },\n  actions: {\n    /**\n     * @class opened\n     * @description 从持久化数据载入分页列表\n     * @param {Object} state vuex state\n     */\n    openedLoad: function openedLoad(_ref) {\n      var state = _ref.state,\n          commit = _ref.commit,\n          dispatch = _ref.dispatch;\n      return new Promise(\n      /*#__PURE__*/\n      function () {\n        var _ref2 = _asyncToGenerator(\n        /*#__PURE__*/\n        regeneratorRuntime.mark(function _callee(resolve) {\n          var value, valid;\n          return regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  _context.next = 2;\n                  return dispatch('d2admin/db/get', {\n                    dbName: 'sys',\n                    path: 'page.opened',\n                    defaultValue: setting.page.opened,\n                    user: true\n                  }, {\n                    root: true\n                  });\n\n                case 2:\n                  value = _context.sent;\n                  // 在处理函数中进行数据优化 过滤掉现在已经失效的页签或者已经改变了信息的页签\n                  // 以 name 字段为准\n                  // 如果页面过多的话可能需要优化算法\n                  // valid 有效列表 1, 1, 0, 1 => 有效, 有效, 失效, 有效\n                  valid = []; // 处理数据\n\n                  state.opened = value.map(function (opened) {\n                    // 忽略首页\n                    if (opened.name === 'index') {\n                      valid.push(1);\n                      return opened;\n                    } // 尝试在所有的支持多标签页的页面里找到 name 匹配的页面\n\n\n                    var find = state.pool.find(function (item) {\n                      return item.name === opened.name;\n                    }); // 记录有效或无效信息\n\n                    valid.push(find ? 1 : 0); // 返回合并后的数据 新的覆盖旧的\n                    // 新的数据中一般不会携带 params 和 query, 所以旧的参数会留存\n\n                    return Object.assign({}, opened, find);\n                  }).filter(function (opened, index) {\n                    return valid[index] === 1;\n                  }); // 根据 opened 数据生成缓存设置\n\n                  commit('keepAliveRefresh'); // end\n\n                  resolve();\n\n                case 7:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        }));\n\n        return function (_x) {\n          return _ref2.apply(this, arguments);\n        };\n      }());\n    },\n\n    /**\n     * 将 opened 属性赋值并持久化 在这之前请先确保已经更新了 state.opened\n     * @param {Object} state vuex state\n     */\n    opend2db: function opend2db(_ref3) {\n      var state = _ref3.state,\n          dispatch = _ref3.dispatch;\n      return new Promise(\n      /*#__PURE__*/\n      function () {\n        var _ref4 = _asyncToGenerator(\n        /*#__PURE__*/\n        regeneratorRuntime.mark(function _callee2(resolve) {\n          return regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  // 设置数据\n                  dispatch('d2admin/db/set', {\n                    dbName: 'sys',\n                    path: 'page.opened',\n                    value: state.opened,\n                    user: true\n                  }, {\n                    root: true\n                  }); // end\n\n                  resolve();\n\n                case 2:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2);\n        }));\n\n        return function (_x2) {\n          return _ref4.apply(this, arguments);\n        };\n      }());\n    },\n\n    /**\n     * @class opened\n     * @description 更新页面列表上的某一项\n     * @param {Object} state vuex state\n     * @param {Object} param { index, params, query } 路由信息\n     */\n    openedUpdate: function openedUpdate(_ref5, _ref6) {\n      var state = _ref5.state,\n          commit = _ref5.commit,\n          dispatch = _ref5.dispatch;\n      var index = _ref6.index,\n          params = _ref6.params,\n          query = _ref6.query;\n      return new Promise(\n      /*#__PURE__*/\n      function () {\n        var _ref7 = _asyncToGenerator(\n        /*#__PURE__*/\n        regeneratorRuntime.mark(function _callee3(resolve) {\n          var page;\n          return regeneratorRuntime.wrap(function _callee3$(_context3) {\n            while (1) {\n              switch (_context3.prev = _context3.next) {\n                case 0:\n                  // 更新页面列表某一项\n                  page = state.opened[index];\n                  page.params = params || page.params;\n                  page.query = query || page.query;\n                  state.opened.splice(index, 1, page); // 增加缓存设置\n\n                  if (isKeepAlive(page)) {\n                    commit('keepAlivePush', page.name);\n                  } // 持久化\n\n\n                  _context3.next = 7;\n                  return dispatch('opend2db');\n\n                case 7:\n                  // end\n                  resolve();\n\n                case 8:\n                case \"end\":\n                  return _context3.stop();\n              }\n            }\n          }, _callee3);\n        }));\n\n        return function (_x3) {\n          return _ref7.apply(this, arguments);\n        };\n      }());\n    },\n\n    /**\n     * @class opened\n     * @description 新增一个 tag (打开一个页面)\n     * @param {Object} state vuex state\n     * @param {Object} param new tag info\n     */\n    add: function add(_ref8, _ref9) {\n      var state = _ref8.state,\n          commit = _ref8.commit,\n          dispatch = _ref8.dispatch;\n      var tag = _ref9.tag,\n          params = _ref9.params,\n          query = _ref9.query;\n      return new Promise(\n      /*#__PURE__*/\n      function () {\n        var _ref10 = _asyncToGenerator(\n        /*#__PURE__*/\n        regeneratorRuntime.mark(function _callee4(resolve) {\n          var newTag;\n          return regeneratorRuntime.wrap(function _callee4$(_context4) {\n            while (1) {\n              switch (_context4.prev = _context4.next) {\n                case 0:\n                  // 设置新的 tag 在新打开一个以前没打开过的页面时使用\n                  newTag = tag;\n                  newTag.params = params || newTag.params;\n                  newTag.query = query || newTag.query; // 添加进当前显示的页面数组\n\n                  state.opened.push(newTag); // 如果这个页面需要缓存 将其添加到缓存设置\n\n                  if (isKeepAlive(newTag)) {\n                    commit('keepAlivePush', tag.name);\n                  } // 持久化\n\n\n                  _context4.next = 7;\n                  return dispatch('opend2db');\n\n                case 7:\n                  // end\n                  resolve();\n\n                case 8:\n                case \"end\":\n                  return _context4.stop();\n              }\n            }\n          }, _callee4);\n        }));\n\n        return function (_x4) {\n          return _ref10.apply(this, arguments);\n        };\n      }());\n    },\n\n    /**\n     * @class current\n     * @description 打开一个新的页面\n     * @param {Object} state vuex state\n     * @param {Object} param { name, params, query } 路由信息\n     */\n    open: function open(_ref11, _ref12) {\n      var state = _ref11.state,\n          commit = _ref11.commit,\n          dispatch = _ref11.dispatch;\n      var name = _ref12.name,\n          params = _ref12.params,\n          query = _ref12.query;\n      return new Promise(\n      /*#__PURE__*/\n      function () {\n        var _ref13 = _asyncToGenerator(\n        /*#__PURE__*/\n        regeneratorRuntime.mark(function _callee5(resolve) {\n          var opened, pageOpendIndex, pageOpend, page;\n          return regeneratorRuntime.wrap(function _callee5$(_context5) {\n            while (1) {\n              switch (_context5.prev = _context5.next) {\n                case 0:\n                  // 已经打开的页面\n                  opened = state.opened; // 判断此页面是否已经打开 并且记录位置\n\n                  pageOpendIndex = 0;\n                  pageOpend = opened.find(function (page, index) {\n                    var same = page.name === name;\n                    pageOpendIndex = same ? index : pageOpendIndex;\n                    return same;\n                  });\n\n                  if (!pageOpend) {\n                    _context5.next = 8;\n                    break;\n                  }\n\n                  _context5.next = 6;\n                  return dispatch('openedUpdate', {\n                    index: pageOpendIndex,\n                    params: params,\n                    query: query\n                  });\n\n                case 6:\n                  _context5.next = 12;\n                  break;\n\n                case 8:\n                  // 页面以前没有打开过\n                  page = state.pool.find(function (t) {\n                    return t.name === name;\n                  }); // 如果这里没有找到 page 代表这个路由虽然在框架内 但是不参与标签页显示\n\n                  if (!page) {\n                    _context5.next = 12;\n                    break;\n                  }\n\n                  _context5.next = 12;\n                  return dispatch('add', {\n                    tag: page,\n                    params: params,\n                    query: query\n                  });\n\n                case 12:\n                  commit('currentSet', name); // end\n\n                  resolve();\n\n                case 14:\n                case \"end\":\n                  return _context5.stop();\n              }\n            }\n          }, _callee5);\n        }));\n\n        return function (_x5) {\n          return _ref13.apply(this, arguments);\n        };\n      }());\n    },\n\n    /**\n     * @class opened\n     * @description 关闭一个 tag (关闭一个页面)\n     * @param {Object} state vuex state\n     * @param {Object} param { tagName: 要关闭的标签名字, vm: vue }\n     */\n    close: function close(_ref14, _ref15) {\n      var state = _ref14.state,\n          commit = _ref14.commit,\n          dispatch = _ref14.dispatch;\n      var tagName = _ref15.tagName,\n          vm = _ref15.vm;\n      return new Promise(\n      /*#__PURE__*/\n      function () {\n        var _ref16 = _asyncToGenerator(\n        /*#__PURE__*/\n        regeneratorRuntime.mark(function _callee6(resolve) {\n          var newPage, isCurrent, len, i, index, _newPage, _newPage$name, name, _newPage$params, params, _newPage$query, query, routerObj;\n\n          return regeneratorRuntime.wrap(function _callee6$(_context6) {\n            while (1) {\n              switch (_context6.prev = _context6.next) {\n                case 0:\n                  // 下个新的页面\n                  newPage = state.opened[0];\n                  isCurrent = state.current === tagName; // 如果关闭的页面就是当前显示的页面\n\n                  if (!isCurrent) {\n                    _context6.next = 12;\n                    break;\n                  }\n\n                  // 去找一个新的页面\n                  len = state.opened.length;\n                  i = 1;\n\n                case 5:\n                  if (!(i < len)) {\n                    _context6.next = 12;\n                    break;\n                  }\n\n                  if (!(state.opened[i].name === tagName)) {\n                    _context6.next = 9;\n                    break;\n                  }\n\n                  if (i < len - 1) {\n                    newPage = state.opened[i + 1];\n                  } else {\n                    newPage = state.opened[i - 1];\n                  }\n\n                  return _context6.abrupt(\"break\", 12);\n\n                case 9:\n                  i++;\n                  _context6.next = 5;\n                  break;\n\n                case 12:\n                  // 找到这个页面在已经打开的数据里是第几个\n                  index = state.opened.findIndex(function (page) {\n                    return page.name === tagName;\n                  });\n\n                  if (index >= 0) {\n                    // 更新数据 删除关闭的页面\n                    state.opened.splice(index, 1); // 如果这个页面是缓存的页面 将其在缓存设置中删除\n\n                    commit('keepAliveRemove', tagName);\n                  } // 持久化\n\n\n                  _context6.next = 16;\n                  return dispatch('opend2db');\n\n                case 16:\n                  // 最后需要判断是否需要跳到首页\n                  if (isCurrent) {\n                    _newPage = newPage, _newPage$name = _newPage.name, name = _newPage$name === void 0 ? '' : _newPage$name, _newPage$params = _newPage.params, params = _newPage$params === void 0 ? {} : _newPage$params, _newPage$query = _newPage.query, query = _newPage$query === void 0 ? {} : _newPage$query;\n                    routerObj = {\n                      name: name,\n                      params: params,\n                      query: query\n                    };\n                    vm.$router.push(routerObj);\n                  } // end\n\n\n                  resolve();\n\n                case 18:\n                case \"end\":\n                  return _context6.stop();\n              }\n            }\n          }, _callee6);\n        }));\n\n        return function (_x6) {\n          return _ref16.apply(this, arguments);\n        };\n      }());\n    },\n\n    /**\n     * @class opened\n     * @description 关闭当前标签左边的标签\n     * @param {Object} state vuex state\n     * @param {Object} param { pageSelect: 当前选中的tagName, vm: vue }\n     */\n    closeLeft: function closeLeft(_ref17) {\n      var state = _ref17.state,\n          commit = _ref17.commit,\n          dispatch = _ref17.dispatch;\n\n      var _ref18 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n          pageSelect = _ref18.pageSelect,\n          vm = _ref18.vm;\n\n      return new Promise(\n      /*#__PURE__*/\n      function () {\n        var _ref19 = _asyncToGenerator(\n        /*#__PURE__*/\n        regeneratorRuntime.mark(function _callee7(resolve) {\n          var pageAim, currentIndex;\n          return regeneratorRuntime.wrap(function _callee7$(_context7) {\n            while (1) {\n              switch (_context7.prev = _context7.next) {\n                case 0:\n                  pageAim = pageSelect || state.current;\n                  currentIndex = 0;\n                  state.opened.forEach(function (page, index) {\n                    if (page.name === pageAim) {\n                      currentIndex = index;\n                    }\n                  });\n\n                  if (currentIndex > 0) {\n                    // 删除打开的页面 并在缓存设置中删除\n                    state.opened.splice(1, currentIndex - 1).forEach(function (_ref20) {\n                      var name = _ref20.name;\n                      return commit('keepAliveRemove', name);\n                    });\n                  }\n\n                  state.current = pageAim;\n\n                  if (vm && vm.$route.name !== pageAim) {\n                    vm.$router.push({\n                      name: pageAim\n                    });\n                  } // 持久化\n\n\n                  _context7.next = 8;\n                  return dispatch('opend2db');\n\n                case 8:\n                  // end\n                  resolve();\n\n                case 9:\n                case \"end\":\n                  return _context7.stop();\n              }\n            }\n          }, _callee7);\n        }));\n\n        return function (_x7) {\n          return _ref19.apply(this, arguments);\n        };\n      }());\n    },\n\n    /**\n     * @class opened\n     * @description 关闭当前标签右边的标签\n     * @param {Object} state vuex state\n     * @param {Object} param { pageSelect: 当前选中的tagName, vm: vue }\n     */\n    closeRight: function closeRight(_ref21) {\n      var state = _ref21.state,\n          commit = _ref21.commit,\n          dispatch = _ref21.dispatch;\n\n      var _ref22 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n          pageSelect = _ref22.pageSelect,\n          vm = _ref22.vm;\n\n      return new Promise(\n      /*#__PURE__*/\n      function () {\n        var _ref23 = _asyncToGenerator(\n        /*#__PURE__*/\n        regeneratorRuntime.mark(function _callee8(resolve) {\n          var pageAim, currentIndex;\n          return regeneratorRuntime.wrap(function _callee8$(_context8) {\n            while (1) {\n              switch (_context8.prev = _context8.next) {\n                case 0:\n                  pageAim = pageSelect || state.current;\n                  currentIndex = 0;\n                  state.opened.forEach(function (page, index) {\n                    if (page.name === pageAim) {\n                      currentIndex = index;\n                    }\n                  }); // 删除打开的页面 并在缓存设置中删除\n\n                  state.opened.splice(currentIndex + 1).forEach(function (_ref24) {\n                    var name = _ref24.name;\n                    return commit('keepAliveRemove', name);\n                  }); // 设置当前的页面\n\n                  state.current = pageAim;\n\n                  if (vm && vm.$route.name !== pageAim) {\n                    vm.$router.push({\n                      name: pageAim\n                    });\n                  } // 持久化\n\n\n                  _context8.next = 8;\n                  return dispatch('opend2db');\n\n                case 8:\n                  // end\n                  resolve();\n\n                case 9:\n                case \"end\":\n                  return _context8.stop();\n              }\n            }\n          }, _callee8);\n        }));\n\n        return function (_x8) {\n          return _ref23.apply(this, arguments);\n        };\n      }());\n    },\n\n    /**\n     * @class opened\n     * @description 关闭当前激活之外的 tag\n     * @param {Object} state vuex state\n     * @param {Object} param { pageSelect: 当前选中的tagName, vm: vue }\n     */\n    closeOther: function closeOther(_ref25) {\n      var state = _ref25.state,\n          commit = _ref25.commit,\n          dispatch = _ref25.dispatch;\n\n      var _ref26 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n          pageSelect = _ref26.pageSelect,\n          vm = _ref26.vm;\n\n      return new Promise(\n      /*#__PURE__*/\n      function () {\n        var _ref27 = _asyncToGenerator(\n        /*#__PURE__*/\n        regeneratorRuntime.mark(function _callee9(resolve) {\n          var pageAim, currentIndex;\n          return regeneratorRuntime.wrap(function _callee9$(_context9) {\n            while (1) {\n              switch (_context9.prev = _context9.next) {\n                case 0:\n                  pageAim = pageSelect || state.current;\n                  currentIndex = 0;\n                  state.opened.forEach(function (page, index) {\n                    if (page.name === pageAim) {\n                      currentIndex = index;\n                    }\n                  }); // 删除打开的页面数据 并更新缓存设置\n\n                  if (currentIndex === 0) {\n                    state.opened.splice(1).forEach(function (_ref28) {\n                      var name = _ref28.name;\n                      return commit('keepAliveRemove', name);\n                    });\n                  } else {\n                    state.opened.splice(currentIndex + 1).forEach(function (_ref29) {\n                      var name = _ref29.name;\n                      return commit('keepAliveRemove', name);\n                    });\n                    state.opened.splice(1, currentIndex - 1).forEach(function (_ref30) {\n                      var name = _ref30.name;\n                      return commit('keepAliveRemove', name);\n                    });\n                  } // 设置新的页面\n\n\n                  state.current = pageAim;\n\n                  if (vm && vm.$route.name !== pageAim) {\n                    vm.$router.push({\n                      name: pageAim\n                    });\n                  } // 持久化\n\n\n                  _context9.next = 8;\n                  return dispatch('opend2db');\n\n                case 8:\n                  // end\n                  resolve();\n\n                case 9:\n                case \"end\":\n                  return _context9.stop();\n              }\n            }\n          }, _callee9);\n        }));\n\n        return function (_x9) {\n          return _ref27.apply(this, arguments);\n        };\n      }());\n    },\n\n    /**\n     * @class opened\n     * @description 关闭所有 tag\n     * @param {Object} state vuex state\n     * @param {Object} vm vue\n     */\n    closeAll: function closeAll(_ref31, vm) {\n      var state = _ref31.state,\n          commit = _ref31.commit,\n          dispatch = _ref31.dispatch;\n      return new Promise(\n      /*#__PURE__*/\n      function () {\n        var _ref32 = _asyncToGenerator(\n        /*#__PURE__*/\n        regeneratorRuntime.mark(function _callee10(resolve) {\n          return regeneratorRuntime.wrap(function _callee10$(_context10) {\n            while (1) {\n              switch (_context10.prev = _context10.next) {\n                case 0:\n                  // 删除打开的页面 并在缓存设置中删除\n                  state.opened.splice(1).forEach(function (_ref33) {\n                    var name = _ref33.name;\n                    return commit('keepAliveRemove', name);\n                  }); // 持久化\n\n                  _context10.next = 3;\n                  return dispatch('opend2db');\n\n                case 3:\n                  // 关闭所有的标签页后需要判断一次现在是不是在首页\n                  if (vm.$route.name !== 'index') {\n                    vm.$router.push({\n                      name: 'index'\n                    });\n                  } // end\n\n\n                  resolve();\n\n                case 5:\n                case \"end\":\n                  return _context10.stop();\n              }\n            }\n          }, _callee10);\n        }));\n\n        return function (_x10) {\n          return _ref32.apply(this, arguments);\n        };\n      }());\n    }\n  },\n  mutations: {\n    /**\n     * @class keepAlive\n     * @description 从已经打开的页面记录中更新需要缓存的页面记录\n     * @param {Object} state vuex state\n     */\n    keepAliveRefresh: function keepAliveRefresh(state) {\n      state.keepAlive = state.opened.filter(function (item) {\n        return isKeepAlive(item);\n      }).map(function (e) {\n        return e.name;\n      });\n    },\n\n    /**\n     * @description 删除一个页面的缓存设置\n     * @param {Object} state vuex state\n     * @param {String} name name\n     */\n    keepAliveRemove: function keepAliveRemove(state, name) {\n      var list = _toConsumableArray(state.keepAlive);\n\n      remove(list, function (item) {\n        return item === name;\n      });\n      state.keepAlive = list;\n    },\n\n    /**\n     * @description 增加一个页面的缓存设置\n     * @param {Object} state vuex state\n     * @param {String} name name\n     */\n    keepAlivePush: function keepAlivePush(state, name) {\n      var keep = _toConsumableArray(state.keepAlive);\n\n      keep.push(name);\n      state.keepAlive = Array.from(new Set(keep));\n    },\n\n    /**\n     * @description 清空页面缓存设置\n     * @param {Object} state vuex state\n     */\n    keepAliveClean: function keepAliveClean(state) {\n      state.keepAlive = [];\n    },\n\n    /**\n     * @class current\n     * @description 设置当前激活的页面 name\n     * @param {Object} state vuex state\n     * @param {String} name new name\n     */\n    currentSet: function currentSet(state, name) {\n      state.current = name;\n    },\n\n    /**\n     * @class pool\n     * @description 保存 pool (候选池)\n     * @param {Object} state vuex state\n     * @param {Array} routes routes\n     */\n    init: function init(state, routes) {\n      var pool = [];\n\n      var push = function push(routes) {\n        routes.forEach(function (route) {\n          if (route.children) {\n            push(route.children);\n          } else {\n            if (!route.hidden) {\n              var meta = route.meta,\n                  name = route.name,\n                  path = route.path;\n              pool.push({\n                meta: meta,\n                name: name,\n                path: path\n              });\n            }\n          }\n        });\n      };\n\n      push(routes);\n      state.pool = pool;\n    }\n  }\n};",{"version":3,"sources":["/home/user1/桌面/vue/D2AdminICE-master/src/store/modules/d2admin/modules/page.js"],"names":["remove","get","setting","isKeepAlive","data","namespaced","state","pool","opened","page","current","keepAlive","actions","openedLoad","commit","dispatch","Promise","resolve","dbName","path","defaultValue","user","root","value","valid","map","name","push","find","item","Object","assign","filter","index","opend2db","openedUpdate","params","query","splice","add","tag","newTag","open","pageOpendIndex","pageOpend","same","t","close","tagName","vm","newPage","isCurrent","len","length","i","findIndex","routerObj","$router","closeLeft","pageSelect","pageAim","currentIndex","forEach","$route","closeRight","closeOther","closeAll","mutations","keepAliveRefresh","e","keepAliveRemove","list","keepAlivePush","keep","Array","from","Set","keepAliveClean","currentSet","init","routes","route","children","hidden","meta"],"mappings":"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","sourcesContent":["import { remove, get } from 'lodash'\n\n// 设置文件\nimport setting from '@/setting.js'\n\n// 判定是否需要缓存\nconst isKeepAlive = data => get(data, 'meta.cache', false)\n\nexport default {\n  namespaced: true,\n  state: {\n    // 可以在多页 tab 模式下显示的页面\n    pool: [],\n    // 当前显示的多页面列表\n    opened: setting.page.opened,\n    // 当前页面\n    current: '',\n    // 需要缓存的页面 name\n    keepAlive: []\n  },\n  actions: {\n    /**\n     * @class opened\n     * @description 从持久化数据载入分页列表\n     * @param {Object} state vuex state\n     */\n    openedLoad ({ state, commit, dispatch }) {\n      return new Promise(async resolve => {\n        // store 赋值\n        const value = await dispatch('d2admin/db/get', {\n          dbName: 'sys',\n          path: 'page.opened',\n          defaultValue: setting.page.opened,\n          user: true\n        }, { root: true })\n        // 在处理函数中进行数据优化 过滤掉现在已经失效的页签或者已经改变了信息的页签\n        // 以 name 字段为准\n        // 如果页面过多的话可能需要优化算法\n        // valid 有效列表 1, 1, 0, 1 => 有效, 有效, 失效, 有效\n        const valid = []\n        // 处理数据\n        state.opened = value.map(opened => {\n          // 忽略首页\n          if (opened.name === 'index') {\n            valid.push(1)\n            return opened\n          }\n          // 尝试在所有的支持多标签页的页面里找到 name 匹配的页面\n          const find = state.pool.find(item => item.name === opened.name)\n          // 记录有效或无效信息\n          valid.push(find ? 1 : 0)\n          // 返回合并后的数据 新的覆盖旧的\n          // 新的数据中一般不会携带 params 和 query, 所以旧的参数会留存\n          return Object.assign({}, opened, find)\n        }).filter((opened, index) => valid[index] === 1)\n        // 根据 opened 数据生成缓存设置\n        commit('keepAliveRefresh')\n        // end\n        resolve()\n      })\n    },\n    /**\n     * 将 opened 属性赋值并持久化 在这之前请先确保已经更新了 state.opened\n     * @param {Object} state vuex state\n     */\n    opend2db ({ state, dispatch }) {\n      return new Promise(async resolve => {\n        // 设置数据\n        dispatch('d2admin/db/set', {\n          dbName: 'sys',\n          path: 'page.opened',\n          value: state.opened,\n          user: true\n        }, { root: true })\n        // end\n        resolve()\n      })\n    },\n    /**\n     * @class opened\n     * @description 更新页面列表上的某一项\n     * @param {Object} state vuex state\n     * @param {Object} param { index, params, query } 路由信息\n     */\n    openedUpdate ({ state, commit, dispatch }, { index, params, query }) {\n      return new Promise(async resolve => {\n        // 更新页面列表某一项\n        let page = state.opened[index]\n        page.params = params || page.params\n        page.query = query || page.query\n        state.opened.splice(index, 1, page)\n        // 增加缓存设置\n        if (isKeepAlive(page)) {\n          commit('keepAlivePush', page.name)\n        }\n        // 持久化\n        await dispatch('opend2db')\n        // end\n        resolve()\n      })\n    },\n    /**\n     * @class opened\n     * @description 新增一个 tag (打开一个页面)\n     * @param {Object} state vuex state\n     * @param {Object} param new tag info\n     */\n    add ({ state, commit, dispatch }, { tag, params, query }) {\n      return new Promise(async resolve => {\n        // 设置新的 tag 在新打开一个以前没打开过的页面时使用\n        let newTag = tag\n        newTag.params = params || newTag.params\n        newTag.query = query || newTag.query\n        // 添加进当前显示的页面数组\n        state.opened.push(newTag)\n        // 如果这个页面需要缓存 将其添加到缓存设置\n        if (isKeepAlive(newTag)) {\n          commit('keepAlivePush', tag.name)\n        }\n        // 持久化\n        await dispatch('opend2db')\n        // end\n        resolve()\n      })\n    },\n    /**\n     * @class current\n     * @description 打开一个新的页面\n     * @param {Object} state vuex state\n     * @param {Object} param { name, params, query } 路由信息\n     */\n    open ({ state, commit, dispatch }, { name, params, query }) {\n      return new Promise(async resolve => {\n        // 已经打开的页面\n        let opened = state.opened\n        // 判断此页面是否已经打开 并且记录位置\n        let pageOpendIndex = 0\n        const pageOpend = opened.find((page, index) => {\n          const same = page.name === name\n          pageOpendIndex = same ? index : pageOpendIndex\n          return same\n        })\n        if (pageOpend) {\n          // 页面以前打开过 但是新的页面可能 name 一样，参数不一样\n          await dispatch('openedUpdate', {\n            index: pageOpendIndex,\n            params,\n            query\n          })\n        } else {\n          // 页面以前没有打开过\n          let page = state.pool.find(t => t.name === name)\n          // 如果这里没有找到 page 代表这个路由虽然在框架内 但是不参与标签页显示\n          if (page) {\n            await dispatch('add', {\n              tag: page,\n              params,\n              query\n            })\n          }\n        }\n        commit('currentSet', name)\n        // end\n        resolve()\n      })\n    },\n    /**\n     * @class opened\n     * @description 关闭一个 tag (关闭一个页面)\n     * @param {Object} state vuex state\n     * @param {Object} param { tagName: 要关闭的标签名字, vm: vue }\n     */\n    close ({ state, commit, dispatch }, { tagName, vm }) {\n      return new Promise(async resolve => {\n        // 下个新的页面\n        let newPage = state.opened[0]\n        const isCurrent = state.current === tagName\n        // 如果关闭的页面就是当前显示的页面\n        if (isCurrent) {\n          // 去找一个新的页面\n          let len = state.opened.length\n          for (let i = 1; i < len; i++) {\n            if (state.opened[i].name === tagName) {\n              if (i < len - 1) {\n                newPage = state.opened[i + 1]\n              } else {\n                newPage = state.opened[i - 1]\n              }\n              break\n            }\n          }\n        }\n        // 找到这个页面在已经打开的数据里是第几个\n        const index = state.opened.findIndex(page => page.name === tagName)\n        if (index >= 0) {\n          // 更新数据 删除关闭的页面\n          state.opened.splice(index, 1)\n          // 如果这个页面是缓存的页面 将其在缓存设置中删除\n          commit('keepAliveRemove', tagName)\n        }\n        // 持久化\n        await dispatch('opend2db')\n        // 最后需要判断是否需要跳到首页\n        if (isCurrent) {\n          const { name = '', params = {}, query = {} } = newPage\n          let routerObj = {\n            name,\n            params,\n            query\n          }\n          vm.$router.push(routerObj)\n        }\n        // end\n        resolve()\n      })\n    },\n    /**\n     * @class opened\n     * @description 关闭当前标签左边的标签\n     * @param {Object} state vuex state\n     * @param {Object} param { pageSelect: 当前选中的tagName, vm: vue }\n     */\n    closeLeft ({ state, commit, dispatch }, { pageSelect, vm } = {}) {\n      return new Promise(async resolve => {\n        const pageAim = pageSelect || state.current\n        let currentIndex = 0\n        state.opened.forEach((page, index) => {\n          if (page.name === pageAim) {\n            currentIndex = index\n          }\n        })\n        if (currentIndex > 0) {\n          // 删除打开的页面 并在缓存设置中删除\n          state.opened.splice(1, currentIndex - 1).forEach(({ name }) => commit('keepAliveRemove', name))\n        }\n        state.current = pageAim\n        if (vm && vm.$route.name !== pageAim) {\n          vm.$router.push({\n            name: pageAim\n          })\n        }\n        // 持久化\n        await dispatch('opend2db')\n        // end\n        resolve()\n      })\n    },\n    /**\n     * @class opened\n     * @description 关闭当前标签右边的标签\n     * @param {Object} state vuex state\n     * @param {Object} param { pageSelect: 当前选中的tagName, vm: vue }\n     */\n    closeRight ({ state, commit, dispatch }, { pageSelect, vm } = {}) {\n      return new Promise(async resolve => {\n        const pageAim = pageSelect || state.current\n        let currentIndex = 0\n        state.opened.forEach((page, index) => {\n          if (page.name === pageAim) {\n            currentIndex = index\n          }\n        })\n        // 删除打开的页面 并在缓存设置中删除\n        state.opened.splice(currentIndex + 1).forEach(({ name }) => commit('keepAliveRemove', name))\n        // 设置当前的页面\n        state.current = pageAim\n        if (vm && vm.$route.name !== pageAim) {\n          vm.$router.push({\n            name: pageAim\n          })\n        }\n        // 持久化\n        await dispatch('opend2db')\n        // end\n        resolve()\n      })\n    },\n    /**\n     * @class opened\n     * @description 关闭当前激活之外的 tag\n     * @param {Object} state vuex state\n     * @param {Object} param { pageSelect: 当前选中的tagName, vm: vue }\n     */\n    closeOther ({ state, commit, dispatch }, { pageSelect, vm } = {}) {\n      return new Promise(async resolve => {\n        const pageAim = pageSelect || state.current\n        let currentIndex = 0\n        state.opened.forEach((page, index) => {\n          if (page.name === pageAim) {\n            currentIndex = index\n          }\n        })\n        // 删除打开的页面数据 并更新缓存设置\n        if (currentIndex === 0) {\n          state.opened.splice(1).forEach(({ name }) => commit('keepAliveRemove', name))\n        } else {\n          state.opened.splice(currentIndex + 1).forEach(({ name }) => commit('keepAliveRemove', name))\n          state.opened.splice(1, currentIndex - 1).forEach(({ name }) => commit('keepAliveRemove', name))\n        }\n        // 设置新的页面\n        state.current = pageAim\n        if (vm && vm.$route.name !== pageAim) {\n          vm.$router.push({\n            name: pageAim\n          })\n        }\n        // 持久化\n        await dispatch('opend2db')\n        // end\n        resolve()\n      })\n    },\n    /**\n     * @class opened\n     * @description 关闭所有 tag\n     * @param {Object} state vuex state\n     * @param {Object} vm vue\n     */\n    closeAll ({ state, commit, dispatch }, vm) {\n      return new Promise(async resolve => {\n        // 删除打开的页面 并在缓存设置中删除\n        state.opened.splice(1).forEach(({ name }) => commit('keepAliveRemove', name))\n        // 持久化\n        await dispatch('opend2db')\n        // 关闭所有的标签页后需要判断一次现在是不是在首页\n        if (vm.$route.name !== 'index') {\n          vm.$router.push({\n            name: 'index'\n          })\n        }\n        // end\n        resolve()\n      })\n    }\n  },\n  mutations: {\n    /**\n     * @class keepAlive\n     * @description 从已经打开的页面记录中更新需要缓存的页面记录\n     * @param {Object} state vuex state\n     */\n    keepAliveRefresh (state) {\n      state.keepAlive = state.opened.filter(item => isKeepAlive(item)).map(e => e.name)\n    },\n    /**\n     * @description 删除一个页面的缓存设置\n     * @param {Object} state vuex state\n     * @param {String} name name\n     */\n    keepAliveRemove (state, name) {\n      const list = [ ...state.keepAlive ]\n      remove(list, item => item === name)\n      state.keepAlive = list\n    },\n    /**\n     * @description 增加一个页面的缓存设置\n     * @param {Object} state vuex state\n     * @param {String} name name\n     */\n    keepAlivePush (state, name) {\n      const keep = [ ...state.keepAlive ]\n      keep.push(name)\n      state.keepAlive = Array.from(new Set(keep))\n    },\n    /**\n     * @description 清空页面缓存设置\n     * @param {Object} state vuex state\n     */\n    keepAliveClean (state) {\n      state.keepAlive = []\n    },\n    /**\n     * @class current\n     * @description 设置当前激活的页面 name\n     * @param {Object} state vuex state\n     * @param {String} name new name\n     */\n    currentSet (state, name) {\n      state.current = name\n    },\n    /**\n     * @class pool\n     * @description 保存 pool (候选池)\n     * @param {Object} state vuex state\n     * @param {Array} routes routes\n     */\n    init (state, routes) {\n      const pool = []\n      const push = function (routes) {\n        routes.forEach(route => {\n          if (route.children) {\n            push(route.children)\n          } else {\n            if (!route.hidden) {\n              const { meta, name, path } = route\n              pool.push({ meta, name, path })\n            }\n          }\n        })\n      }\n      push(routes)\n      state.pool = pool\n    }\n  }\n}\n"]}]}